<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ5 - –ú–ê–Ü</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
            padding: 10px;
        }

        .step::after {
            content: '';
            position: absolute;
            top: 20px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #dee2e6;
            z-index: 0;
        }

        .step:last-child::after {
            display: none;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #dee2e6;
            color: #6c757d;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 5px;
            position: relative;
            z-index: 1;
        }

        .step.active .step-number {
            background: #667eea;
            color: white;
        }

        .step.completed .step-number {
            background: #28a745;
            color: white;
        }

        .step-label {
            font-size: 12px;
            color: #6c757d;
            font-weight: 500;
        }

        .content {
            padding: 30px;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            margin-bottom: 30px;
        }

        .form-section h3 {
            color: #495057;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .input-group {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }

        .input-group label {
            font-weight: 500;
            color: #495057;
        }

        .input-group input {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            width: 150px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .project-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .project-tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .project-tab.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .criteria-input {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .criteria-input label {
            font-size: 12px;
            color: #6c757d;
            font-weight: 500;
        }

        .criteria-input input {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .results-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .result-section {
            margin-bottom: 30px;
        }

        .result-section h4 {
            color: #495057;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #dee2e6;
        }

        .matrix-display {
            overflow-x: auto;
            margin: 15px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px;
            text-align: center;
            border: 1px solid #dee2e6;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .priority-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: white;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .priority-item.best {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .priority-label {
            font-weight: 600;
            color: #495057;
        }

        .priority-value {
            font-weight: 700;
            color: #667eea;
        }

        .priority-item.best .priority-value {
            color: #28a745;
        }

        .conclusion {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .conclusion h3 {
            margin-bottom: 15px;
            font-size: 24px;
        }

        .conclusion p {
            font-size: 18px;
            line-height: 1.6;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .load-example {
            background: #ffc107;
            color: #212529;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .load-example:hover {
            background: #e0a800;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ5</h1>
            <p>–Ü–º—ñ—Ç–∞—Ü—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è –≤–∏–±–æ—Ä—É —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤ (–ú–ê–Ü)</p>
        </div>

        <div class="progress-bar">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">–ì—Ä—É–ø–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">–ü—Ä–æ–µ–∫—Ç 1</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">–ü—Ä–æ–µ–∫—Ç 2</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">–ü—Ä–æ–µ–∫—Ç 3</div>
            </div>
            <div class="step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏</div>
            </div>
        </div>

        <div class="content">
            <!-- –ö—Ä–æ–∫ 1: –í–∞–≥–∏ –≥—Ä—É–ø –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ -->
            <div class="step-content active" id="step1">
                <h2>–ö—Ä–æ–∫ 1: –í–∞–≥–∏ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –≥—Ä—É–ø –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ (2-–π —Ä—ñ–≤–µ–Ω—å)</h2>
                <div class="alert alert-info">
                    üí° –í–≤–µ–¥—ñ—Ç—å –≤–∞–≥–∏ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –∑–∞ —à–∫–∞–ª–æ—é –≤—ñ–¥ 1 –¥–æ 9
                </div>
                
                <button class="load-example" onclick="loadExampleData()">
                    üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö
                </button>

                <div class="form-section">
                    <div class="input-group">
                        <label>–ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó (E):</label>
                        <input type="number" id="weight_e" min="1" max="9" step="1" value="7">
                    </div>
                    <div class="input-group">
                        <label>–¢–µ—Ö–Ω—ñ—á–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó (T):</label>
                        <input type="number" id="weight_t" min="1" max="9" step="1" value="5">
                    </div>
                    <div class="input-group">
                        <label>–í–∏—Ä–æ–±–Ω–∏—á—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó (B):</label>
                        <input type="number" id="weight_b" min="1" max="9" step="1" value="4">
                    </div>
                    <div class="input-group">
                        <label>–ï–∫–æ–ª–æ–≥—ñ—á–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó (P):</label>
                        <input type="number" id="weight_p" min="1" max="9" step="1" value="6">
                    </div>
                    <div class="input-group">
                        <label>–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó (R):</label>
                        <input type="number" id="weight_r" min="1" max="9" step="1" value="3">
                    </div>
                </div>

                <div class="btn-group">
                    <div></div>
                    <button class="btn btn-primary" onclick="nextStep(2)">
                        –î–∞–ª—ñ ‚Üí
                    </button>
                </div>
            </div>

            <!-- –ö—Ä–æ–∫–∏ 2-4: –ü—Ä–æ–µ–∫—Ç–∏ -->
            <div class="step-content" id="step2">
                <h2>–ö—Ä–æ–∫ 2: –í–∞–≥–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –¥–ª—è –ü—Ä–æ–µ–∫—Ç—É 1</h2>
                <div class="alert alert-info">
                    üí° –í–≤–µ–¥—ñ—Ç—å –æ—Ü—ñ–Ω–∫–∏ (1-9 –±–∞–ª—ñ–≤) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É
                </div>
                <div id="project1-form"></div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="prevStep(1)">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(3)">
                        –î–∞–ª—ñ ‚Üí
                    </button>
                </div>
            </div>

            <div class="step-content" id="step3">
                <h2>–ö—Ä–æ–∫ 3: –í–∞–≥–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –¥–ª—è –ü—Ä–æ–µ–∫—Ç—É 2</h2>
                <div class="alert alert-info">
                    üí° –í–≤–µ–¥—ñ—Ç—å –æ—Ü—ñ–Ω–∫–∏ (1-9 –±–∞–ª—ñ–≤) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É
                </div>
                <div id="project2-form"></div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="prevStep(2)">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(4)">
                        –î–∞–ª—ñ ‚Üí
                    </button>
                </div>
            </div>

            <div class="step-content" id="step4">
                <h2>–ö—Ä–æ–∫ 4: –í–∞–≥–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –¥–ª—è –ü—Ä–æ–µ–∫—Ç—É 3</h2>
                <div class="alert alert-info">
                    üí° –í–≤–µ–¥—ñ—Ç—å –æ—Ü—ñ–Ω–∫–∏ (1-9 –±–∞–ª—ñ–≤) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É
                </div>
                <div id="project3-form"></div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="prevStep(3)">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                    <button class="btn btn-success" onclick="calculate()">
                        üßÆ –û–±—á–∏—Å–ª–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
                    </button>
                </div>
            </div>

            <!-- –ö—Ä–æ–∫ 5: –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ -->
            <div class="step-content" id="step5">
                <h2>–ö—Ä–æ–∫ 5: –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑—É –ú–ê–Ü</h2>
                <div id="results"></div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="prevStep(4)">
                        ‚Üê –ù–∞–∑–∞–¥ –¥–æ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
                    </button>
                    <button class="btn btn-success" onclick="exportResults()">
                        üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const criteriaGroups = [
            { name: '–ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ', code: 'e', labels: ['–ß–ü–î', '–¢–µ—Ä–º—ñ–Ω –æ–∫—É–ø–Ω–æ—Å—Ç—ñ', '–ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏', '–†–æ–∑–º—ñ—Ä —ñ–Ω–≤–µ—Å—Ç–∏—Ü—ñ–π'] },
            { name: '–¢–µ—Ö–Ω—ñ—á–Ω—ñ', code: 't', labels: ['–¢–µ—Ö–Ω—ñ—á–Ω–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å', '–ù–∞—è–≤–Ω—ñ—Å—Ç—å –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è', '–†—ñ–≤–µ–Ω—å –≤–∏—Ç—Ä–∞—Ç –µ–Ω–µ—Ä–≥—ñ—ó', '–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –µ–Ω–µ—Ä–≥–æ—É—Ç–∏–ª—ñ–∑–∞—Ü—ñ—ó'] },
            { name: '–í–∏—Ä–æ–±–Ω–∏—á—ñ', code: 'b', labels: ['–ì–ª–∏–±–∏–Ω–∞ –ø–µ—Ä–µ—Ä–æ–±–∫–∏', '–ï–Ω–µ—Ä–≥–æ—î–º–Ω—ñ—Å—Ç—å –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞', '–ï–Ω–µ—Ä–≥–æ—î–º–Ω—ñ—Å—Ç—å —Ñ–æ–Ω–¥—ñ–≤', '–ï–Ω–µ—Ä–≥–æ–æ–∑–±—Ä–æ—î–Ω—ñ—Å—Ç—å –ø—Ä–∞—Ü—ñ'] },
            { name: '–ï–∫–æ–ª–æ–≥—ñ—á–Ω—ñ', code: 'p', labels: ['–ó–º–µ–Ω—à–µ–Ω–Ω—è –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è', '–ó–º–µ–Ω—à–µ–Ω–Ω—è –≤–∏–∫–∏–¥—ñ–≤', '–ó–º—ñ–Ω–∞ –º—ñ–∫—Ä–æ–∫–ª—ñ–º–∞—Ç—É', '–ó–º–µ–Ω—à–µ–Ω–Ω—è —Ç–µ–ø–ª–æ–≤–æ–≥–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è'] },
            { name: '–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ', code: 'r', labels: ['–ù–∞—è–≤–Ω—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É', '–ù–∞—è–≤–Ω—ñ—Å—Ç—å –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è', '–¢–µ—Ä–º—ñ–Ω–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó', '–ß–∞—Å –∂–∏—Ç—Ç—è –ø—Ä–æ–µ–∫—Ç—É'] }
        ];

        let currentStep = 1;
        let results = {};

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ñ–æ—Ä–º –¥–ª—è –ø—Ä–æ–µ–∫—Ç—ñ–≤
        function initProjectForms() {
            for (let p = 1; p <= 3; p++) {
                const container = document.getElementById(`project${p}-form`);
                let html = '';
                
                criteriaGroups.forEach(group => {
                    html += `<div class="form-section">
                        <h3>${group.name} –∫—Ä–∏—Ç–µ—Ä—ñ—ó</h3>
                        <div class="criteria-grid">`;
                    
                    for (let i = 0; i < 4; i++) {
                        html += `<div class="criteria-input">
                            <label>${group.labels[i]}</label>
                            <input type="number" id="p${p}_${group.code}${i}" min="1" max="9" step="1" value="5">
                        </div>`;
                    }
                    
                    html += `</div></div>`;
                });
                
                container.innerHTML = html;
            }
        }

        function loadExampleData() {
            // –ü—Ä–æ–µ–∫—Ç 1
            const p1 = [[8,7,9,6], [5,6,7,5], [8,7,9,6], [9,8,7,8], [5,6,5,4]];
            // –ü—Ä–æ–µ–∫—Ç 2
            const p2 = [[6,7,5,8], [8,9,7,8], [5,6,4,6], [4,5,6,4], [7,8,7,6]];
            // –ü—Ä–æ–µ–∫—Ç 3
            const p3 = [[4,5,3,5], [6,5,6,4], [4,5,3,5], [6,7,5,6], [4,5,6,5]];
            
            const projects = [p1, p2, p3];
            
            for (let p = 0; p < 3; p++) {
                for (let g = 0; g < 5; g++) {
                    for (let c = 0; c < 4; c++) {
                        document.getElementById(`p${p+1}_${criteriaGroups[g].code}${c}`).value = projects[p][g][c];
                    }
                }
            }
            
            alert('‚úÖ –ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!');
        }

        function nextStep(step) {
            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.step').forEach(el => {
                el.classList.remove('active');
                if (parseInt(el.dataset.step) < step) {
                    el.classList.add('completed');
                }
            });
            
            document.getElementById(`step${step}`).classList.add('active');
            document.querySelector(`[data-step="${step}"]`).classList.add('active');
            currentStep = step;
            window.scrollTo(0, 0);
        }

        function prevStep(step) {
            nextStep(step);
        }

        // –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ú–ê–Ü
        function createPairwiseMatrix(weights) {
            const n = weights.length;
            const matrix = [];
            for (let i = 0; i < n; i++) {
                matrix[i] = [];
                for (let j = 0; j < n; j++) {
                    matrix[i][j] = weights[i] / weights[j];
                }
            }
            return matrix;
        }

        function calculateEigenvector(matrix) {
            const n = matrix.length;
            const eigenvector = [];
            for (let i = 0; i < n; i++) {
                let product = 1;
                for (let j = 0; j < n; j++) {
                    product *= matrix[i][j];
                }
                eigenvector[i] = Math.pow(product, 1/n);
            }
            return eigenvector;
        }

        function calculatePriorityVector(eigenvector) {
            const sum = eigenvector.reduce((a, b) => a + b, 0);
            return eigenvector.map(v => v / sum);
        }

        function calculate() {
            // –ó–±–∏—Ä–∞—î–º–æ –¥–∞–Ω—ñ
            const groupWeights = [
                parseFloat(document.getElementById('weight_e').value),
                parseFloat(document.getElementById('weight_t').value),
                parseFloat(document.getElementById('weight_b').value),
                parseFloat(document.getElementById('weight_p').value),
                parseFloat(document.getElementById('weight_r').value)
            ];

            // –ö—Ä–æ–∫ 3: –ú–∞—Ç—Ä–∏—Ü—è –ø–æ–ø–∞—Ä–Ω–∏—Ö –ø–æ—Ä—ñ–≤–Ω—è–Ω—å –≥—Ä—É–ø
            const matrixA = createPairwiseMatrix(groupWeights);
            const eigenvectorA = calculateEigenvector(matrixA);
            const priorityVectorA = calculatePriorityVector(eigenvectorA);

            // –ö—Ä–æ–∫ 4: –û–±—Ä–æ–±–∫–∞ –ø—Ä–æ–µ–∫—Ç—ñ–≤
            const projectPriorities = [];
            const projectData = [];

            for (let p = 1; p <= 3; p++) {
                const projectWeights = [];
                criteriaGroups.forEach(group => {
                    const weights = [];
                    for (let i = 0; i < 4; i++) {
                        weights.push(parseFloat(document.getElementById(`p${p}_${group.code}${i}`).value));
                    }
                    projectWeights.push(weights);
                });
                projectData.push(projectWeights);
            }

            // –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—ñ–≤ –∑–∞ –∫–æ–∂–Ω–æ—é –≥—Ä—É–ø–æ—é
            const projectGroupPriorities = [];
            for (let p = 0; p < 3; p++) {
                projectGroupPriorities[p] = [];
            }

            for (let g = 0; g < 5; g++) {
                const avgWeights = [];
                for (let p = 0; p < 3; p++) {
                    const avg = projectData[p][g].reduce((a, b) => a + b, 0) / 4;
                    avgWeights.push(avg);
                }
                
                const matrix = createPairwiseMatrix(avgWeights);
                const eigenvector = calculateEigenvector(matrix);
                const priorities = calculatePriorityVector(eigenvector);
                
                for (let p = 0; p < 3; p++) {
                    projectGroupPriorities[p][g] = priorities[p];
                }
            }

            // –ö—Ä–æ–∫ 5: –ì–ª–æ–±–∞–ª—å–Ω—ñ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏
            const globalPriorities = [];
            for (let p = 0; p < 3; p++) {
                let sum = 0;
                for (let g = 0; g < 5; g++) {
                    sum += projectGroupPriorities[p][g] * priorityVectorA[g];
                }
                globalPriorities.push(sum);
            }

            // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
            results = {
                groupWeights,
                matrixA,
                priorityVectorA,
                projectGroupPriorities,
                globalPriorities
            };

            displayResults();
            nextStep(5);
        }

        function displayResults() {
            const resultsDiv = document.getElementById('results');
            const { groupWeights, matrixA, priorityVectorA, projectGroupPriorities, globalPriorities } = results;

            // –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É
            const bestIndex = globalPriorities.indexOf(Math.max(...globalPriorities));
            const sortedIndices = globalPriorities.map((v, i) => [v, i]).sort((a, b) => b[0] - a[0]);

            let html = '<div class="alert alert-success">‚úÖ –û–±—á–∏—Å–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ!</div>';

            // –ö—Ä–æ–∫ 3: –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏ –≥—Ä—É–ø
            html += '<div class="result-section">';
            html += '<h4>üìä –ö—Ä–æ–∫ 3: –í–µ–∫—Ç–æ—Ä –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—ñ–≤ –≥—Ä—É–ø –∫—Ä–∏—Ç–µ—Ä—ñ—ó—ñ–≤ (A—Ä)</h4>';
            html += '<div class="matrix-display">';
            html += '<table><thead><tr><th>–ì—Ä—É–ø–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤</th><th>–í–∞–≥–∞</th><th>–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç</th><th>–í—ñ–¥—Å–æ—Ç–æ–∫</th></tr></thead><tbody>';
            
            criteriaGroups.forEach((group, i) => {
                html += `<tr>
                    <td><strong>${group.name}</strong></td>
                    <td>${groupWeights[i]}</td>
                    <td>${priorityVectorA[i].toFixed(4)}</td>
                    <td>${(priorityVectorA[i] * 100).toFixed(2)}%</td>
                </tr>`;
            });
            html += '</tbody></table></div></div>';

            // –ö—Ä–æ–∫ 4: –ú–∞—Ç—Ä–∏—Ü—è –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—ñ–≤ –ø—Ä–æ–µ–∫—Ç—ñ–≤
            html += '<div class="result-section">';
            html += '<h4>üìä –ö—Ä–æ–∫ 4: –ú–∞—Ç—Ä–∏—Ü—è –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—ñ–≤ –ø—Ä–æ–µ–∫—Ç—ñ–≤ (P)</h4>';
            html += '<div class="matrix-display">';
            html += '<table><thead><tr><th>–ü—Ä–æ–µ–∫—Ç</th>';
            criteriaGroups.forEach(g => html += `<th>${g.name}</th>`);
            html += '</tr></thead><tbody>';
            
            for (let p = 0; p < 3; p++) {
                html += `<tr><td><strong>–ü—Ä–æ–µ–∫—Ç ${p+1}</strong></td>`;
                projectGroupPriorities[p].forEach(priority => {
                    html += `<td>${priority.toFixed(4)}</td>`;
                });
                html += '</tr>';
            }
            html += '</tbody></table></div></div>';

            // –ö—Ä–æ–∫ 5: –ì–ª–æ–±–∞–ª—å–Ω—ñ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏
            html += '<div class="result-section">';
            html += '<h4>üéØ –ö—Ä–æ–∫ 5: –í–µ–∫—Ç–æ—Ä –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—ñ–≤ (G)</h4>';
            
            for (let i = 0; i < 3; i++) {
                const [priority, index] = sortedIndices[i];
                const isBest = index === bestIndex;
                html += `<div class="priority-item ${isBest ? 'best' : ''}">
                    <span class="priority-label">–ü—Ä–æ–µ–∫—Ç ${index + 1} ${isBest ? '<span class="badge badge-success">–†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–û</span>' : ''}</span>
                    <span class="priority-value">G${index + 1} = ${priority.toFixed(4)} (${(priority * 100).toFixed(2)}%)</span>
                </div>`;
            }
            html += '</div>';

            // –í–∏—Å–Ω–æ–≤–æ–∫
            html += `<div class="conclusion">
                <h3>üèÜ –í–∏—Å–Ω–æ–≤–æ–∫</h3>
                <p>–î–æ –ø–µ—Ä—à–æ—á–µ—Ä–≥–æ–≤–æ—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è <strong>–ü–†–û–ï–ö–¢ ${bestIndex + 1}</strong><br>
                –∑ –≥–ª–æ–±–∞–ª—å–Ω–∏–º –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–æ–º <strong>${globalPriorities[bestIndex].toFixed(4)} (${(globalPriorities[bestIndex] * 100).toFixed(2)}%)</strong></p>
            </div>`;

            resultsDiv.innerHTML = html;
        }

        function exportResults() {
            const { groupWeights, priorityVectorA, projectGroupPriorities, globalPriorities } = results;
            
            let text = '='*80 + '\n';
            text += '–†–ï–ó–£–õ–¨–¢–ê–¢–ò –õ–ê–ë–û–†–ê–¢–û–†–ù–û–á –†–û–ë–û–¢–ò ‚Ññ5\n';
            text += '–ú–µ—Ç–æ–¥ –∞–Ω–∞–ª—ñ–∑—É —ñ—î—Ä–∞—Ä—Ö—ñ–π (–ú–ê–Ü)\n';
            text += '='*80 + '\n\n';
            
            text += '–í–ï–ö–¢–û–† –ü–†–Ü–û–†–ò–¢–ï–¢–Ü–í –ì–†–£–ü –ö–†–ò–¢–ï–†–Ü–á–í:\n';
            criteriaGroups.forEach((g, i) => {
                text += `  ${g.name}: ${priorityVectorA[i].toFixed(4)} (${(priorityVectorA[i]*100).toFixed(2)}%)\n`;
            });
            
            text += '\n–í–ï–ö–¢–û–† –ì–õ–û–ë–ê–õ–¨–ù–ò–• –ü–†–Ü–û–†–ò–¢–ï–¢–Ü–í:\n';
            globalPriorities.forEach((p, i) => {
                text += `  –ü—Ä–æ–µ–∫—Ç ${i+1}: ${p.toFixed(4)} (${(p*100).toFixed(2)}%)\n`;
            });
            
            const bestIndex = globalPriorities.indexOf(Math.max(...globalPriorities));
            text += `\n–†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –ü—Ä–æ–µ–∫—Ç ${bestIndex + 1}\n`;
            
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'lab5_results.txt';
            a.click();
            
            alert('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É —Ñ–∞–π–ª lab5_results.txt');
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        initProjectForms();
    </script>
</body>
</html>
